--TEST--
Test that internal classes can register intersection types
--EXTENSIONS--
crex_test
spl
--FILE--
<?crx

class C implements Countable {
    public function count(): int {
        return 1;
    }
}

class I extends EmptyIterator implements Countable {
    public function count(): int {
        return 1;
    }
}

$o = new _CrexTestClass();

try {
    var_dump($o->classIntersectionProp);
} catch (Error $e) {
    echo $e::class, ': ', $e->getMessage(), CRX_EOL;
}
try {
    $o->classIntersectionProp = new EmptyIterator();
} catch (TypeError $e) {
    echo $e->getMessage(), CRX_EOL;
}
try {
    $o->classIntersectionProp = new C();
} catch (TypeError $e) {
    echo $e->getMessage(), CRX_EOL;
}
$o->classIntersectionProp = new I();

?>
==DONE==
--EXPECT--
Error: Typed property _CrexTestClass::$classIntersectionProp must not be accessed before initialization
Cannot assign EmptyIterator to property _CrexTestClass::$classIntersectionProp of type Traversable&Countable
Cannot assign C to property _CrexTestClass::$classIntersectionProp of type Traversable&Countable
==DONE==
