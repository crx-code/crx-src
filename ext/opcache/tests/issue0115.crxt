--TEST--
ISSUE #115 (path issue when using crxa)
--INI--
opcache.enable=1
opcache.enable_cli=1
crxa.readonly=0
--EXTENSIONS--
opcache
crxa
--CONFLICTS--
server
--FILE--
<?crx
$stub = '<?crx
Crxa::interceptFileFuncs();
require "crxa://this/index.crx";
__HALT_COMPILER(); ?>';
$p = new Crxa(__DIR__ . '/issue0115_1.crxa.crx', 0, 'this');
$p['index.crx'] = '<?crx
  echo "Hello from Index 1.\n";
  require_once "crxa://this/hello.crx";
';
$p['hello.crx'] = "Hello World 1!\n";
$p->setStub($stub);
unset($p);
$p = new Crxa(__DIR__ . '/issue0115_2.crxa.crx', 0, 'this');
$p['index.crx'] = '<?crx
  echo "Hello from Index 2.\n";
  require_once "crxa://this/hello.crx";
';
$p['hello.crx'] = "Hello World 2!\n";
$p->setStub($stub);
unset($p);

include "crx_cli_server.inc";
crx_cli_server_start('-d opcache.enable=1 -d opcache.enable_cli=1 -d extension=crxa.'.CRX_SHLIB_SUFFIX);
echo file_get_contents('http://' . CRX_CLI_SERVER_ADDRESS . '/issue0115_1.crxa.crx');
echo file_get_contents('http://' . CRX_CLI_SERVER_ADDRESS . '/issue0115_2.crxa.crx');
?>
--CLEAN--
<?crx
@unlink(__DIR__ . '/issue0115_1.crxa.crx');
@unlink(__DIR__ . '/issue0115_2.crxa.crx');
?>
--EXPECT--
Hello from Index 1.
Hello World 1!
Hello from Index 2.
Hello World 2!
