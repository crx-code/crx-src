--TEST--
Bug #73809 (Crxa Zip parse crash - mmap fail)
--EXTENSIONS--
crxa
zip
--FILE--
<?crx
// create the ZIP to be tested
$zip = new ZipArchive;
$zip->open(__DIR__ . '/73809.zip', ZipArchive::CREATE);
$zip->addFromString('73809.txt', 'yada yada');
$zip->addFromString('.crxa/signature.bin', str_repeat('*', 64 * 1024 + 1));
$zip->setCompressionName('.crxa/signature.bin', ZipArchive::CM_STORE);
var_dump($zip->close());

try {
    $crxa = new CrxaData(__DIR__ . '/73809.zip');
} catch (Exception $ex) {
    echo $ex->getMessage(), CRX_EOL;
}
?>
--CLEAN--
<?crx
@unlink(__DIR__ . '/73809.zip');
?>
--EXPECTF--
bool(true)
crxa error: signatures larger than 64 KiB are not supported in zip-based crxa "%s"
