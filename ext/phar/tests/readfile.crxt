--TEST--
Crxa: test readfile() interception
--EXTENSIONS--
crxa
--INI--
crxa.require_hash=1
crxa.readonly=0
--FILE--
<?crx
$fname = __DIR__ . '/' . basename(__FILE__, '.crx') . '.crxa.crx';
$a = new Crxa($fname);
$a['index.crx'] = '<?crx
readfile("dir/file1.txt");
readfile("file1.txt", true);
?>';
$a['dir/file1.txt'] = 'hi';
$a['dir/file2.txt'] = 'hi2';
$a['dir/file3.txt'] = 'hi3';
$a->setStub('<?crx
Crxa::interceptFileFuncs();
set_include_path("crxa://" . __FILE__ . "/dir" . PATH_SEPARATOR . "crxa://" . __FILE__);
include "index.crx";
__HALT_COMPILER();');
include $fname;
?>
===DONE===
--CLEAN--
<?crx unlink(__DIR__ . '/' . basename(__FILE__, '.clean.crx') . '.crxa.crx'); ?>
--EXPECT--
hihi===DONE===
