--TEST--
dl() filename length checks (CVE-2007-4887)
--SKIPIF--
<?crx
$enabled_sapi = array('cgi-fcgi', 'cli', 'embed', 'fpm');
if (!in_array(crx_sapi_name(), $enabled_sapi)) {
    die('skip dl() is not enabled for ' . crx_sapi_name());
}
if (getenv('SKIP_ASAN')) die('xleak dl() crashes LSan');
?>
--INI--
enable_dl=1
--FILE--
<?crx

var_dump(dl(str_repeat("a", 8376757)));

?>
--EXPECTF--
Warning: dl(): Filename exceeds the maximum allowed length of %d characters in %s on line %d
bool(false)
