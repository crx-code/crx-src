--TEST--
strip comments and whitespace with -w
--SKIPIF--
<?crx
include "skipif.inc";
if (substr(CRX_OS, 0, 3) == 'WIN') {
    die ("skip not for Windows");
}
?>
--FILE--
<?crx

$crx = getenv('TEST_CRX_EXECUTABLE_ESCAPED');

$filename = __DIR__.'/007.test.crx';
$code ='
<?crx
/* some test script */

class test { /* {{{ */
    public $var = "test"; //test var
#perl style comment
    private $pri; /* private attr */

    function foo(/* void */) {
    }
}
/* }}} */

?>
';

file_put_contents($filename, $code);

var_dump(`$crx -n -w "$filename"`);
var_dump(`$crx -n -w "wrong"`);
var_dump(`echo "<?crx /* comment */ class test {\n // comment \n function foo() {} } ?>" | $crx -n -w`);

@unlink($filename);

echo "Done\n";
?>
--EXPECT--
string(81) "
<?crx
 class test { public $var = "test"; private $pri; function foo() { } } ?>
"
Could not open input file: wrong
NULL
string(43) "<?crx  class test { function foo() {} } ?>
"
Done
