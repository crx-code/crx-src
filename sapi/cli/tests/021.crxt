--TEST--
CLI shell shebang
--SKIPIF--
<?crx
include 'skipif.inc';
if (substr(CRX_OS, 0, 3) == 'WIN') {
    die ("skip not for Windows");
}

if (str_contains(getenv('TEST_CRX_EXECUTABLE'), " ")) {
    die("skip shebang cannot have spaces in its path");
}

if (strlen("#!".getenv('TEST_CRX_EXECUTABLE')) > 127) {
        die ("skip shebang is too long, see http://www.in-ulm.de/~mascheck/various/shebang/#results");
}
?>
--FILE--
<?crx

$crx = getenv('TEST_CRX_EXECUTABLE');

$filename = __DIR__.'/021.tmp.crx';

$script = "#!$crx -n\n".
          "ola\n".
          "<?crx echo 1+1,'\n';\n".
          "?>\n".
          "adeus\n";

file_put_contents($filename, $script);
chmod($filename, 0777);

echo `$filename`;

echo "\nDone\n";
?>
--CLEAN--
<?crx
unlink(__DIR__.'/021.tmp.crx');
?>
--EXPECT--
ola
2
adeus

Done
