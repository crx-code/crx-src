--TEST--
Digest Authentication
--SKIPIF--
<?crx
include "skipif.inc";
?>
--FILE--
<?crx
include "crx_cli_server.inc";
crx_cli_server_start('var_dump(!isset($_SERVER["CRX_AUTH_USER"]), !isset($_SERVER["CRX_AUTH_PW"]), $_SERVER["CRX_AUTH_DIGEST"]);');

$host = CRX_CLI_SERVER_HOSTNAME;
$fp = crx_cli_server_connect();

if(fwrite($fp, <<<HEADER
GET / HTTP/1.1
Host: {$host}
Authorization: digest username="Mufasa", realm="testrealm@host.com", nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093", uri="/dir/index.html", qop=auth, nc=00000001, cnonce="0a4f113b", response="6629fae49393a05397450978507c4ef1", opaque="5ccc069c403ebaf9f0171e9517f40e41"


HEADER
)) {
	fpassthru($fp);
}

?>
--EXPECTF--
HTTP/1.1 200 OK
Host: %s
Date: %s
Connection: close
X-Powered-By: CRX/%s
Content-type: text/html; charset=UTF-8

bool(true)
bool(true)
string(242) "username="Mufasa", realm="testrealm@host.com", nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093", uri="/dir/index.html", qop=auth, nc=00000001, cnonce="0a4f113b", response="6629fae49393a05397450978507c4ef1", opaque="5ccc069c403ebaf9f0171e9517f40e41""
