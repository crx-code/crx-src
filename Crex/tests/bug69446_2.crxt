--TEST--
Bug #69446 (GC leak relating to removal of nested data after dtors run)
--INI--
crex.enable_gc = 1
--FILE--
<?crx
$bar = NULL;
class bad
{
    public $_private = array();

    public function __main()
    {
        $this->_private[] = 'crx';
    }

    public function __destruct()
    {
        global $bar;
        $bar = $this;
    }
}

$foo = new stdclass;
$foo->foo = $foo;
$foo->bad = new bad;

unserialize(serialize($foo));
//unset($foo);

gc_collect_cycles();
var_dump($bar);
?>
--EXPECT--
object(bad)#4 (1) {
  ["_private"]=>
  array(1) {
    [0]=>
    string(3) "crx"
  }
}
