--TEST--
Typed properties in internal classes
--EXTENSIONS--
crex_test
spl
--FILE--
<?crx

// Internal typed properties

$obj = new _CrexTestClass;
var_dump($obj->intProp);
try {
    $obj->intProp = "foobar";
} catch (TypeError $e) {
    echo $e->getMessage(), "\n";
}
$obj->intProp = 456;

try {
    $obj->classProp = $obj;
} catch (TypeError $e) {
    echo $e->getMessage(), "\n";
}
$obj->classProp = new stdClass;
var_dump($obj);

// Inherit from internal class

class Test extends _CrexTestClass {
}

$obj = new Test;
var_dump($obj->intProp);
try {
    $obj->intProp = "foobar";
} catch (TypeError $e) {
    echo $e->getMessage(), "\n";
}
$obj->intProp = 456;

try {
    $obj->classProp = $obj;
} catch (TypeError $e) {
    echo $e->getMessage(), "\n";
}
$obj->classProp = new stdClass;
var_dump($obj);

// Static internal typed properties

var_dump(_CrexTestClass::$staticIntProp);
try {
    _CrexTestClass::$staticIntProp = "foobar";
} catch (TypeError $e) {
    echo $e->getMessage(), "\n";
}
_CrexTestClass::$staticIntProp = 456;
var_dump(_CrexTestClass::$staticIntProp);

?>
--EXPECT--
int(123)
Cannot assign string to property _CrexTestClass::$intProp of type int
Cannot assign _CrexTestClass to property _CrexTestClass::$classProp of type ?stdClass
object(_CrexTestClass)#1 (3) {
  ["intProp"]=>
  int(456)
  ["classProp"]=>
  object(stdClass)#2 (0) {
  }
  ["classUnionProp"]=>
  NULL
  ["classIntersectionProp"]=>
  uninitialized(Traversable&Countable)
  ["readonlyProp"]=>
  uninitialized(int)
  ["dnfProperty"]=>
  uninitialized(Iterator|(Traversable&Countable))
}
int(123)
Cannot assign string to property _CrexTestClass::$intProp of type int
Cannot assign Test to property _CrexTestClass::$classProp of type ?stdClass
object(Test)#4 (3) {
  ["intProp"]=>
  int(456)
  ["classProp"]=>
  object(stdClass)#1 (0) {
  }
  ["classUnionProp"]=>
  NULL
  ["classIntersectionProp"]=>
  uninitialized(Traversable&Countable)
  ["readonlyProp"]=>
  uninitialized(int)
  ["dnfProperty"]=>
  uninitialized(Iterator|(Traversable&Countable))
}
int(123)
Cannot assign string to property _CrexTestClass::$staticIntProp of type int
int(456)
